---
title: "Functions"
format: pdf
editor: visual
---

```{r}
#install.packages("bio3d)
library(bio3d)
s1 <- read.pdb("4AKE") # kinase with drug
s2 <- read.pdb("1AKE") # kinase no drug
s3 <- read.pdb("1E4Y") # kinase with drug

s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s3, chain="A", elety="CA")

s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b

plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")
```

This function requires an input sequence name ("1AKE"). It will then read in the sequence and documentation, trim it into smaller atoms, select for the B atom, then plot the B factor on the y axis with residues on the x axis and secondary structures highlighted on the x axis as gray and black boxes.

```{r}
qb <- function(t) {
  a <- read.pdb(t) #read in the protein sequence file of interest
  e <- trim.pdb(a, chain = "A", elety = "CA") #trim chain A of the input sequence into multiple atoms, creating smaller pdb vectors
  c <- e$atom$b #select the b atom from the atoms generated by the trim function
  plotb3(c, sse=e, typ="l", ylab="Bfactor") #plot the resulting protein structure with secondary structures highlighted.
}
```

```{r}
qb("4AKE")
qb("1AKE")
qb("1E4Y")
```

```{r}
hc <- hclust( dist( rbind(s1.b, s2.b, s3.b) ) )
plot(hc)
```

Q1. A list object is returned from the read.pdb() function

Q2. trim.pdb() produces a smaller pdb object, containing a subset of atoms, from a larger pdb object.

Q3. excluding the sse parameter would turn off the black and grey rectangles, those black and grey rectangles represent secondary structure objects and where they are located in the protein.

Q4. A dendrogram would allow you to compare similarities between the protein sequences, or atleast measure their deviation from eachother.

Q5. Based off of the dendrogram "1AKE" and "1E4Y" are the most similar to each other.
