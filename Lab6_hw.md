# Functions

``` r
#install.packages("bio3d)
library(bio3d)
s1 <- read.pdb("4AKE") # kinase with drug
```

      Note: Accessing on-line PDB file

``` r
s2 <- read.pdb("1AKE") # kinase no drug
```

      Note: Accessing on-line PDB file
       PDB has ALT records, taking A only, rm.alt=TRUE

``` r
s3 <- read.pdb("1E4Y") # kinase with drug
```

      Note: Accessing on-line PDB file

``` r
s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s3, chain="A", elety="CA")

s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b

plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
```

![](Lab6_hw_files/figure-commonmark/unnamed-chunk-1-1.png)

``` r
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
```

![](Lab6_hw_files/figure-commonmark/unnamed-chunk-1-2.png)

``` r
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")
```

![](Lab6_hw_files/figure-commonmark/unnamed-chunk-1-3.png)

This function requires an input sequence name (“1AKE”). It will then
read in the sequence and documentation, trim it into smaller atoms,
select for the B atom, then plot the B factor on the y axis with
residues on the x axis and secondary structures highlighted on the x
axis as gray and black boxes.

``` r
qb <- function(t) {
  a <- read.pdb(t) #read in the protein sequence file of interest
  e <- trim.pdb(a, chain = "A", elety = "CA") #trim chain A of the input sequence into multiple atoms, creating smaller pdb vectors
  c <- e$atom$b #select the b atom from the atoms generated by the trim function
  plotb3(c, sse=e, typ="l", ylab="Bfactor") #plot the resulting protein structure with secondary structures highlighted.
}
```

``` r
qb("4AKE")
```

      Note: Accessing on-line PDB file

    Warning in get.pdb(file, path = tempdir(), verbose = FALSE):
    /var/folders/73/96snndjs5qj33jhsyprs5yfc0000gn/T//RtmpgPGN0P/4AKE.pdb exists.
    Skipping download

![](Lab6_hw_files/figure-commonmark/unnamed-chunk-3-1.png)

``` r
qb("1AKE")
```

      Note: Accessing on-line PDB file

    Warning in get.pdb(file, path = tempdir(), verbose = FALSE):
    /var/folders/73/96snndjs5qj33jhsyprs5yfc0000gn/T//RtmpgPGN0P/1AKE.pdb exists.
    Skipping download

       PDB has ALT records, taking A only, rm.alt=TRUE

![](Lab6_hw_files/figure-commonmark/unnamed-chunk-3-2.png)

``` r
qb("1E4Y")
```

      Note: Accessing on-line PDB file

    Warning in get.pdb(file, path = tempdir(), verbose = FALSE):
    /var/folders/73/96snndjs5qj33jhsyprs5yfc0000gn/T//RtmpgPGN0P/1E4Y.pdb exists.
    Skipping download

![](Lab6_hw_files/figure-commonmark/unnamed-chunk-3-3.png)

``` r
hc <- hclust( dist( rbind(s1.b, s2.b, s3.b) ) )
plot(hc)
```

![](Lab6_hw_files/figure-commonmark/unnamed-chunk-4-1.png)

Q1. A list object is returned from the read.pdb() function

Q2. trim.pdb() produces a smaller pdb object, containing a subset of
atoms, from a larger pdb object.

Q3. excluding the sse parameter would turn off the black and grey
rectangles, those black and grey rectangles represent secondary
structure objects and where they are located in the protein.

Q4. A dendrogram would allow you to compare similarities between the
protein sequences, or atleast measure their deviation from eachother.

Q5. Based off of the dendrogram “1AKE” and “1E4Y” are the most similar
to each other.
